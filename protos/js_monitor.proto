syntax = "proto3";

package jsmonitor;

import "google/protobuf/timestamp.proto";

service JSMonitorService {
  rpc AddJsFiles (AddJsFilesRequest) returns (AddJsFilesResponse);

  rpc FetchAndUpdateJsFileContent (FetchAndUpdateJsFileContentRequest) returns (JsFileResponse);

  rpc ListJsFiles (ListJsFilesRequest) returns (ListJsFilesResponse);
}

message JsFileCreate {
  string url = 1;
  int32 priority = 2;
  string company_id = 3;
}

message AddJsFilesRequest {
  repeated JsFileCreate files = 1;
}

message AddJsFilesResponse {
  repeated JsFileResponse files = 1;
}

message FetchAndUpdateJsFileContentRequest {
  string file_id = 1;
}

message ListJsFilesRequest {
  string company_id = 1;
  bool fetch_content = 2;
}

message ListJsFilesResponse {
  repeated JsFileResponse files = 1;
}

message JsFileResponse {
  string id = 1;
  string url = 2;
  string host = 3;
  optional string content = 4;
  int32 priority = 5;
  string company_id = 6;
  google.protobuf.Timestamp last_fetched = 7;
  google.protobuf.Timestamp last_updated = 8;
}
